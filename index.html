<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StudyFlow: A/B Test Sample Size & Power Tool</title>

  <!-- Link to external CSS file -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Plotly Library for visualization -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <!-- MathJax for LaTeX rendering -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    #timestamp {
      text-align: right;
      font-size: 0.85rem;
      color: #555;
      margin-right: 1rem;
    }
  </style>
</head>

<body>
  <div id="timestamp"></div>

  <!-- Title -->
  <h1>StudyFlow Influencer A/B Test Planner</h1>

  <!-- Context Section -->
  <div class="intro">
    <p>
      <strong>Context:</strong> As a Data Analyst for StudyFlow (a student study-habit SaaS), your job is to compare the conversion rates of two marketing channels: your current partner, <strong>Influencer Alpha</strong> (Control Group $P_1$), versus the new, more expensive <strong>Influencer Beta</strong> (Variant $P_2$).
    </p>
    <p>
      This tool helps you determine the <strong>Required Sample Size</strong> ($N$ per group) needed for a valid A/B test by adjusting the statistical parameters below.
    </p>
    <p class="equation">
      <strong>Required Sample Size (N) Formula:</strong>
      $$N = \frac{\left[z_{1-\alpha} \sqrt{2P_{pool}(1-P_{pool})} + z_{1-\beta} \sqrt{P_1(1-P_1) + P_2(1-P_2)}\right]^2}{\delta^2}$$
    </p>
  </div>

  <div id="metrics" class="metrics-panel">
    <h2>A/B Test Outcomes</h2>
    <p id="sample_size" class="metric-output"></p>
    <p id="p2_rate" class="metric-output"></p>
  </div>

  <hr class="separator" />

  <!-- Controls -->
  <h3>Test Parameters (What You Decide)</h3>
  <div class="controls-container">
    <div class="control-column">
      <h4>Conversion Rate Assumptions</h4>

      <!-- P1 -->
      <div class="control-group">
        <label>
          P₁ (Alpha's Current Conversion Rate):
          <input type="range" id="p1Slider" min="0.05" max="0.30" step="0.01" value="0.10" />
          <input type="number" id="p1Number" min="0.05" max="0.30" step="0.001" value="0.10" />
          <span id="p1Display" class="display-value">10%</span>
        </label>
      </div>

      <!-- P2 -->
      <div class="control-group">
        <label>
          P₂ (Beta's Expected Conversion Rate):
          <input type="range" id="p2Slider" min="0.05" max="0.30" step="0.01" value="0.13" />
          <input type="number" id="p2Number" min="0.05" max="0.30" step="0.001" value="0.13" />
          <span id="p2Display" class="display-value">13%</span>
        </label>
      </div>

      <!-- Δ -->
      <div class="control-group">
        <label>
          Δ (Observed Lift: |P₂ – P₁|):
          <span id="deltaDisplay" class="display-value">3%</span>
        </label>
      </div>
    </div>

    <div class="control-column">
      <h4>Confidence & Risk Settings</h4>

      <!-- Alpha -->
      <div class="control-group">
        <label>
          α (Significance Level):
          <input type="range" id="alphaSlider" min="0.01" max="0.20" step="0.01" value="0.05" />
          <input type="number" id="alphaNumber" min="0.01" max="0.20" step="0.001" value="0.05" />
          <span id="alphaDisplay" class="display-value">0.05</span>
        </label>
      </div>

      <!-- Power -->
      <div class="control-group">
        <label>
          Power (1–β):
          <input type="range" id="powerSlider" min="0.70" max="0.99" step="0.01" value="0.80" />
          <input type="number" id="powerNumber" min="0.70" max="0.99" step="0.001" value="0.80" />
          <span id="powerDisplay" class="display-value">0.80</span>
        </label>
      </div>
    </div>
  </div>

  <hr class="separator" />

  <div id="plot"></div>

  <div id="questions">
    <h3>Exploratory Questions for StudyFlow Analysts</h3>
    <ol>
      <li>What happens to $N$ when you decrease α?</li>
      <li>Why does a larger Δ drastically decrease the required sample size?</li>
      <li>Should you prefer higher Power or lower α when Beta is expensive?</li>
    </ol>
  </div>

  <script src="app.js" defer></script>

  <script>
    // Timestamp display
    document.addEventListener("DOMContentLoaded", () => {
      const ts = new Date();
      const formatted = ts.toLocaleString();
      document.getElementById("timestamp").textContent = "Last updated: " + formatted;
    });
  </script>
</body>
</html>
